\documentclass[conference]{IEEEtran}
\usepackage{float}
\usepackage{graphicx}
\usepackage[final]{hyperref} % adds hyper links inside the generated pdf file
\usepackage{wrapfig}
\usepackage{booktabs}
\hypersetup{
	colorlinks=true,       % false: boxed links; true: colored links
	linkcolor=blue,        % color of internal links
	citecolor=blue,        % color of links to bibliography
	filecolor=magenta,     % color of file links
	urlcolor=blue
}

%package list
\usepackage[
    backend=bibtex,
    style=numeric,
    sorting=none,
    maxcitenames=2
]{biblatex}


%\addbibresource{main.bib}
\bibliography{references.bib}


\begin{document}

\title{Using {\it imo.im} in Forensic Investigations \\\vspace{5mm} \large  \today}
\author{
\IEEEauthorblockN{Robin Klusman}
\IEEEauthorblockA{
Security and Network Engineering \\
University of Amsterdam \\
robin.klusman@os3.nl}
\and
\IEEEauthorblockN{Luc Gommans}
\IEEEauthorblockA{
Security and Network Engineering \\
University of Amsterdam \\
os3-ccf@lucgommans.nl}
}
\maketitle
\thispagestyle{plain}
\pagestyle{plain}


\section{Introduction}

In recent years, mobile communication tools have gained massively in popularity.
Many mobile device users nowadays use internet based third party messaging
applications over the small message service (SMS) provided by telecom companies.
The advantage of these internet based alternatives is often the more extensive
features an lower cost compared to SMS. It is therefore unsurprising that many
such applications have over hundreds of millions of downloads, making the use of
them widespread. This fact is important for forensics purposes because there are
reasonable odds that a suspect has installed and possibly used at least one such
application to send or receive sensitive data relevant to the case. The
investigation into what data useful in a forensic investigation can be gathered
from such applications, therefore becomes very relevant.

One example of such an application is {\it imo.im}, which currently  has over
half a billion installs. Additionally, this application requests permission to
track the user's location, making it even more interesting for forensic
purposes. If the application indeed tracks and stores a log of a user's location
data, such data could be valuable in court to for instance validate or
invalidate a suspect's alibi.

The remainder of this paper is structured as follows: Section
\ref{sec:researchq} describes our main research question and the defined
sub-questions. In Section \ref{sec:ethics} we discuss the ethical implications
of our work. Section \ref{sec:relwork} gives an overview of the prior work done
in this area of research. %TODO

\section{Research Questions}\label{sec:researchq}

Our main research question is:
{\it What information can be gathered from the `imo' messenger app for Android?}

This main research question divides in four sub-questions:

\begin{enumerate}
    \item What data is identifiably sent over the network?
    \item What message data is available locally?
    \item What location data is available locally?
    \item Do any cached files or images exist locally?
\end{enumerate}


\section{Ethical Considerations}\label{sec:ethics}

For this paper we will use a test environment to examine the data that can be
extracted from the imo android app. We will not be using any real user data and
use only designated test devices to make sure we do not invade or compromise the
privacy of any real imo users.


\section{Related work}\label{sec:relwork}

No prior work has been done on the imo messaging app for any platform, the only
mention of imo in academic literature is in the paper by \citeauthor{zhu}, which
does a more general review of several group messaging applications and does not
conduct an analysis of what data can be acquired for use in a criminal
investigation \cite{zhu}.

Fortunately academic research does exist on the forensic investigation of other
messaging applications. \citeauthor{mahajan2013forensic} conduct a forensic
analysis of the Android messaging applications Viber and Whatsapp
\cite{mahajan2013forensic}. The aim of their paper is to find whether the data
of those applications, such as sent and received messages and images, are stored
locally in a way that they can be extracted from the device.
\citeauthor{mahajan2013forensic} managed to find and extract several artifacts
relevant to a forensic investigation, such as sent and received messages and
contact phone numbers.

\citeauthor{walnycky2015network} conduct an extensive investigation of 20
popular Android messaging applications \cite{walnycky2015network}. In their
paper they investigate what data is can be retrieved by investigating the mobile
device's local storage, the applications' server storage and network traffic
analysis in a forensic investigation for each application. Network traffic is
analysed using three different tools, Wireshark, NetworkMiner and NetWitness
Investigator, for the purpose of cross referencing the results. Server stored
data was investigated by recovering links to the applications' servers from the
network traffic analysis. Locally stored data was acquired and investigated
using Micro-systemation's {\it XRY} and verified by also using {\it Helium
backup} in combination with {\it Android backup extractor} and an sqlite
database browser.  In their paper, \citeauthor{walnycky2015network} state that 4
of the applications leaked no data when subjected to their investigative
methods.  However, their study did find that 16 applications do leak data either
through network communication or local/server storage.

A forensic investigation of WhatsApp is also conducted by
\citeauthor{anglano2014forensic} \cite{anglano2014forensic}, who uses a virtual
Android environment created with {\it YouWave} to investigate what data can be
acquired from WhatsApp through a device's local storage. Their study shows that
it is very feasible to acquire WhatsApp data from local storage, since data such
as sent and received messages and contact information is stored unencrypted on
the local storage.


\section{Method}\label{sec:method}

%todo investigate deleted messages, appear in database?
%todo investigate logout etc
%todo we do not focus on the proper forensic extraction methods but rather on
%the data that is available after such extraction has taken place
%todo add more phone numbers, can we see only phones from contact database or
%also users added manually on imo not in the phone's contacts.
%todo can we see own user telephone number/username

\section{Network Communication}\label{sec:comm}

Most network communication was observed to use TCP ports 443, 5223 and 5228. We
have not been able to identify why the app sometimes uses one over the other.
In the APK, we find references to those three ports together, so we are
confident that there are no other TCP ports in use. Searching online for those
ports, we find that these ports overlap with WhatsApp, C2DM (now-defunct
server-push platform provided by Google, using port 5228) and Apple's push
implementation (APNS, using port 5223). Most likely, imo uses those ports
because they are commonly used by mobile devices for core operating system
features (server push) or other popular applications. Network administrators
are unlikely to block those ports.

UDP port 443 is used for video calls. In contrast, voice-only calls are done
using TCP, using one of the aforementioned ports.

The downloading of stickers is done over TCP port 80 (plain HTTP). Stickers in
imo are large, animated emoticons. Anyone observing the network traffic can
therefore see which emoticons are used by a device. It is not visible, however,
which chat a sticker was used in. %TODO: downloaded only once?

\subsection{Communication format}

The stickers are downloaded over TCP port 80, using HTTP/1.1. A sticker is a
zip archive with one image, in png format, per frame of the animation. The
filenames are sequential numbers: \texttt{1.png}, \texttt{2.png}, etc.

When the app chooses to use port 443 for the bulk of the communication, then
the connection is secured using TLSv1.2. The client offers 20 cipher suites,
among which obsolete ciphers such as \texttt{TLS\_RSA\_WITH\_RC4\_128\_SHA} and
\texttt{TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA}, though this is probably dependent
on the operating system. In our case, the server picked
\texttt{TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256}, which is labeled by Mozilla as
a ciphersuite of intermediate strength\cite{moz-tls}.

When the app choses to use one of the two alternative TCP ports (5223 or 5228),
the connection is encoded using an unknown method. The data is binary and could
be compressed, encrypted or both. When sending multiple kilobytes of repeating
characters, the observed traffic is much smaller, leading us to believe the
data is compressed. It is unknown whether the traffic is also encrypted.

We have not been able to identify the protocol used for UDP traffic.


% \section{Methods and Scope}
%
% We will do both static and dynamic analysis of the application. We limit
% ourselves to the investigation of the imo Android application and do not look
% into the iOS, MacOS or Windows versions. We will look at the stable release,
% not any (potentially volatile) beta releases.
%
% The main point of interest is network traffic and stored data. If network data
% is not (correctly) encrypted or otherwise revealing, this could be useful in an
% active investigation. Stored data is useful for analysis after confiscating a
% device.
%
% To access both the image and network traffic, we will run the application in an
% Android emulator. This allows the host to capture traffic, as well as mount the
% disk image.





\printbibliography

\end{document}

